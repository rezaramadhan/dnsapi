{% extends 'layout.html' %}

{% block content %}
{% load staticfiles%}
		<!-- ## DIR-PATH -->
		<div class="row">
			<ol class="breadcrumb">
				<li><a href="#"><svg class="glyph stroked home"><use xlink:href="#stroked-home"></use></svg></a></li>
				<li class="active">Icons</li>
			</ol>
		</div>

		<!-- ## HEADER -->

		<div class="row home-box">
			<div class="col-md-12">
				<div class="panel panel-primary">
				</div>
			</div>
		</div>


		<!-- ## PANEL TAB CREATE RECORD -->
		<div class="row home-box">
			<div class="col-lg-12">
				<h2>Create New Record</h2>
			</div>

			<div class="col-md-12">
				<div class="panel panel-info">
					<div class="panel-body tabs">

						<ul class="nav nav-pills tab-heading-info">
							<li class="active">
								<a href="#pilltabA" data-toggle="tab">A</a></li>
							<li><a href="#pilltabAAAA" data-toggle="tab">AAAA</a></li>
							<li><a href="#pilltabCNAME" data-toggle="tab">CNAME</a></li>
							<li><a href="#pilltabMX" data-toggle="tab">MX</a></li>
							<li><a href="#pilltabTXT" data-toggle="tab">TXT</a></li>
							<li><a href="#pilltabNS" data-toggle="tab">NS</a></li>
							<li><a href="#pilltabSRV" data-toggle="tab">SRV</a></li>
						</ul>

						<div class="tab-content" >
							<div class="tab-pane fade in active text-box" id="pilltabA">
								<p>A records are for IPv4 addresses only and tell a request where your domain should direct to. </p>
								<!-- ## Add Record Form -->
								<form role="form" class="form-in">
									<div class="form-group-in">
										<label>Hostname</label>
										<input class="form-control" placeholder="Enter Hostname">
									</div>
									<div class="form-group-in">
										<label>Will Direct To</label>
										<input class="form-control" placeholder="Select Resource or custom IP">
									</div>
									<div class="form-group-in">
										<label>TTL (Seconds)</label>
										<select class="form-control">
											<option>60</option>
											<option>120</option>
											<option>1800</option>
											<option selected>3600</option>
										</select>
									</div>
									<button type="submit" class="btn btn-primary">CREATE RECORD</button>
								</form>
							</div>

							<div class="tab-pane fade text-box" id="pilltabAAAA">
								<p>AAAA records are for IPv6 addresses only and tell a request where your domain should direct to. </p>
								<!-- ## Add Record Form -->
								<form role="form" class="form-in">
									<div class="form-group-in">
										<label>Hostname</label>
										<input class="form-control" placeholder="Enter Hostname">
									</div>
									<div class="form-group-in">
										<label>Will Direct To</label>
										<input class="form-control" placeholder="Select Resource or custom IP">
									</div>
									<div class="form-group-in">
										<label>TTL (Seconds)</label>
										<select class="form-control">
											<option>60</option>
											<option>120</option>
											<option>1800</option>
											<option selected>3600</option>
										</select>
									</div>
									<button type="submit" class="btn btn-primary">CREATE RECORD</button>
								</form>
							</div>

							<div class="tab-pane fade text-box" id="pilltabCNAME">
								<p>CNAME records act as an alias by mapping a hostname to another hostname. </p>
								<!-- ## Add Record Form -->
								<form role="form" class="form-in">
									<div class="form-group-in">
										<label>Hostname</label>
										<input class="form-control" placeholder="Enter Hostname">
									</div>
									<div class="form-group-in">
										<label>Is An Alias Of</label>
										<input class="form-control" placeholder="Enter Hostname">
									</div>
									<div class="form-group-in">
										<label>TTL (Seconds)</label>
										<select class="form-control">
											<option>60</option>
											<option>120</option>
											<option>1800</option>
											<option selected>3600</option>
										</select>
									</div>
									<button type="submit" class="btn btn-primary">CREATE RECORD</button>
								</form>
							</div>

							<div class="tab-pane fade text-box" id="pilltabMX">
								<p>MX records specify the mail servers responsible for accepting emails on behalf of your domain,
									and priority value if your provider has a number of mail servers for contingency. </p>
								<!-- ## Add Record Form -->
								<form role="form" class="form-in">
									<div class="form-group-in">
										<label>Hostname</label>
										<input class="form-control" placeholder="Enter Hostname">
									</div>
									<div class="form-group-in">
										<label>Mail Providers Mail Servers</label>
										<input class="form-control" placeholder="Enter Mail Providers Servers">
									</div>
									<div class="form-group-in">
										<label>Priority</label>
										<input class="form-control" placeholder="e.g. 10">
									</div>
									<div class="form-group-in">
										<label>TTL (Seconds)</label>
										<select class="form-control">
											<option>1800</option>
											<option>3600</option>
											<option>7200</option>
											<option selected>14400</option>
										</select>
									</div>
									<button type="submit" class="btn btn-primary">CREATE RECORD</button>
								</form>
							</div>

							<div class="tab-pane fade text-box" id="pilltabTXT">
								<p>TXT records are used to associate a string of text with hostname. These are primarily used for verification.</p>
								<!-- ## Add Record Form -->
								<form role="form" class="form-in">
									<div class="form-group-in form-group">
										<label>Value</label>
										<input class="form-control" placeholder="Paste TXT string here">
									</div>
									<div class="form-group-in">
										<label>Will Direct To</label>
										<input class="form-control" placeholder="Select Resource or custom IP">
									</div>
									<div class="form-group-in">
										<label>TTL (Seconds)</label>
										<select class="form-control">
											<option>60</option>
											<option>120</option>
											<option>1800</option>
											<option selected>3600</option>
										</select>
									</div>
									<button type="submit" class="btn btn-primary">CREATE RECORD</button>
								</form>
							</div>

							<div class="tab-pane fade text-box" id="pilltabNS">
								<p>SRV records specify the location (hostname and port number) of servers for specific services.
									You can use service records to direct certain types of traffic to particular sercers.. </p>
								<!-- ## Add Record Form -->
								<form role="form" class="form-in">
									<div class="form-group-in">
										<label>Hostname</label>
										<input class="form-control" placeholder="Enter Hostname">
									</div>
									<div class="form-group-in">
										<label>Will Direct To</label>
										<input class="form-control" placeholder="Enter Nameserver">
									</div>
									<div class="form-group-in">
										<label>TTL (Seconds)</label>
										<select class="form-control">
											<option>60</option>
											<option>120</option>
											<option>1800</option>
											<option selected>3600</option>
										</select>
									</div>
									<button type="submit" class="btn btn-primary">CREATE RECORD</button>
								</form>
							</div>

							<div class="tab-pane fade text-box" id="pilltabSRV">
								<p>A records are for IPv4 addresses only and tell a request where your domain should direct to. </p>
								<!-- ## Add Record Form -->
								<form role="form" class="form-in">
									<div class="form-group-in">
										<label>Hostname</label>
										<input class="form-control" placeholder="Enter Hostname">
									</div>
									<div class="form-group-in">
										<label>Will Direct To</label>
										<input class="form-control" placeholder="Select Resource or custom IP">
									</div>
									<div class="form-group-in">
										<label>TTL (Seconds)</label>
										<select class="form-control">
											<option>60</option>
											<option>120</option>
											<option>1800</option>
											<option selected>3600</option>
										</select>
									</div>
									<button type="submit" class="btn btn-primary">CREATE RECORD</button>
								</form>
							</div>

						</div>
					</div>
				</div><!--/.panel-->
			</div><!-- /.col-->

		</div><!-- /.row -->




		<!-- ## DNS RECORD - TABLE  -->
		<div class="row home-box">
			<div class="col-lg-12">
				<h2>DNS Record</h2>
			</div>

			<div class="row table-box">
				<div class="col-lg-12">
					<div class="panel panel-default">
						<div class="panel-heading">List of registered DNS records.</div>
						<div class="panel-body">
							<table id="resourcerecord"
											data-show-refresh="true"
											data-show-toggle="true"
											data-show-columns="true"
											data-search="true"
											data-select-item-name="toolbar1"
											data-pagination="true"
											data-sort-name="name"
											data-sort-order="asc">
							    <thead>
							    <tr>
											<th data-formatter="runningFormatter">Index</th>
							        <th data-field="rtype" data-sortable="true" >Type</th>
							        <th data-field="name" data-sortable="true">Hostname</th>
							        <th data-field="rdata.address"  data-sortable="true">Value</th>
							        <th data-field="ttl" data-sortable="true">TTL</th>
											<th data-field="action" data-align="center"
													data-formatter="actionFormatter" data-events="actionEvents">Action</th>
							    </tr>
							    </thead>
							</table>
						</div>
					</div>
				</div>
			</div><!--/.row-->

{% endblock %}

{% block script %}
{% load staticfiles%}

	<script>
			function responFlatenedJson(data) {
				var result = {};
				var resultarray = [];
				function recurse (cur, prop) {
						if (Object(cur) !== cur) {
								result[prop] = cur;
						} else if (Array.isArray(cur)) {
								 for(var i=0, l=cur.length; i<l; i++)
										 recurse(cur[i], prop + "[" + i + "]");
								if (l == 0)
										result[prop] = [];
						} else {
								var isEmpty = true;
								for (var p in cur) {
										isEmpty = false;
										recurse(cur[p], prop ? prop+"."+p : p);
								}
								if (isEmpty && prop)
										result[prop] = {};
						}
				}
				//Recurse is absolute function to flattened an object jsonFromFile
				//Below loop is to only flatten each object inside array, not
				//the whole array, so the result is still array of object (with flattened object).
				//credit : kucik.in
				for(var i=0, l=data.length; i<l; i++){
						recurse(data[i], "");
						resultarray.push(result);
						result = {}
				}
				return resultarray;
				//original code to flattened whole array
				// recurse(data, "");
    		// return result;
			}

			$.getJSON("http://{{ request.get_host }}/api/gdn.lokal", function (jsonFromFile) {
					$('#resourcerecord').bootstrapTable({
						data: responFlatenedJson(jsonFromFile.resource_records)
					})
			});

	</script>

	<script>

			function actionFormatter(value, row, index) {
				return [
						'<a class="edit btn-action action-edit" href="javascript:void(0)" title="Edit">',
						'<i class="glyphicon glyphicon-edit"></i>',
						'</a>',
						'<a class="remove btn-action action-del" href="javascript:void(0)" title="Remove">',
						'<i class="glyphicon glyphicon-remove"></i>',
						'</a>'
				].join('');
			}

			function runningFormatter(value, row, index) {
			    return index+1;
			}

			window.actionEvents = {
				'click .edit': function (e, value, row, index) {
						alert('Edit, row: ' + JSON.stringify(row));
						console.log(value, row, index);
				},
				'click .remove': function (e, value, row, index) {
						alert('You click remove icon, row: ' + JSON.stringify(row));
						console.log(value, row, index);
				}
			};
	</script>
{% endblock %}
